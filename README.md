# SIFT-CNN-hybrid
This project implements the code to create a hybrid model which combines a basic CNN with handcrafted SIFT features. The CNN is based on the ALL-CNN-A network from https://github.com/wtsyang/dl-reproducibility-project/blob/master/Report.ipynb. The dataset used is CIFAR-10. The SIFT features are created using OpenCV's Dense SIFT feature generator, which creates a set amount of features which are then flattened and combined with the flattened feature maps created by the CNN. The combined feature vector is then fed to a series of fully connected layers which output the results. By default the training batch size is 256, the learning rate 0.05 and the network is trained for 350 epochs. Preprocessing includes random horizontal flipping, random cropping and normalization.<br/>
In summary, the hybrid model outperforms the CNN by about 1.6%. Which makes it hard to justify the 2-3 times increase in learning time.
The results can be recreated by simply running main.py, which will automatically download all relevant data. It then starts the training of the hybrid model with listed parameters. The cnn results can either be viewed over at the listed github link or recreated using this code by altering it slightly. One needs to switch out the classifier with the CNN, change the input data in trainer.py from cuda to regular data and finally uncomment the last Conv2d, ReLU and AdaptiveAvgPool2D layers in cnn.py. <br/>
To test out the code on other datasets such as the FASHION-MNIST, one needs to simply alter the torch.datasets code located in the loader.py. 
